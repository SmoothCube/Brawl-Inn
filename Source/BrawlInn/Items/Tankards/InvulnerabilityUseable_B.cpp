// Fill out your copyright notice in the Description page of Project Settings.


#include "InvulnerabilityUseable_B.h"
#include "BrawlInn.h"
#include "Characters/Player/PlayerCharacter_B.h"
#include "GameFramework/CharacterMovementComponent.h"

void AInvulnerabilityUseable_B::Use_Implementation()
{
	Character = Cast<APlayerCharacter_B>(GetAttachParentActor());
	if (!Character) { BWarn("Could not find player while using, something is wrong! ABORT!"); return; }

	OldMovementSpeed = Character->NormalMaxWalkSpeed;
	OldAcceleration = Character->GetCharacterMovement()->MaxAcceleration;

	Character->MakeInvulnerable();
	Character->GetCharacterMovement()->MaxAcceleration = OldAcceleration + AccelerationBoost;
	Character->GetCharacterMovement()->MaxWalkSpeed = OldMovementSpeed + MovementSpeedBoost;
	Character->NormalMaxWalkSpeed = OldMovementSpeed + MovementSpeedBoost;
	BWarn("boosting!");

	Super::Use_Implementation();
}

void AInvulnerabilityUseable_B::ResetBoost()
{
	if (Character)
	{
		BWarn("Setting boost back!");
		Character->MakeVulnerable();
		Character->GetCharacterMovement()->MaxWalkSpeed = OldMovementSpeed;
		Character->GetCharacterMovement()->MaxAcceleration = OldAcceleration;
		Character->NormalMaxWalkSpeed = OldMovementSpeed;
	}
}
